<html>
  <head>
      <meta charset="utf-8">
      <title>Atomizer Web</title>

      <link href='style.css' rel='stylesheet'>
      <meta content='Web app for Aotmizer - Atomic CSS on steroids' name='description'>
  </head>
  <body>
    <div class='wrapper'>
      <div class='top-section'>
        <header>
          <h1>
            Atomizer <span>Web</span> â€” <cite>Atomic CSS on steroids | by <a href="http://pankajparashar.com">@pankajparashar</a> | Report Issues on <a href="https://github.com/pankajparashar/atomizer-web">Github</a></cite>
          </h1>
        </header>
      </div>
      <div class='app-section'>
        <div class='tabs-section'>
          <div class='tab css'>
            <h2>Markup <a class="options" id="config">config</a></h2>
          </div>
          <div class='tab sass'>
            <h2>Atomic CSS <a class="options" id="select-all">select all</a></h2>
          </div>

        </div>
        <div class='code-section'>
          <form action='/' id='page' method='POST'>
            <div class='code-container left'>
              <textarea id='markup'></textarea>
            </div>
            <div class='code-container right'>
              <textarea id='atomic_css'></textarea>
            </div>
          </form>
        </div>
        <div class="configjs">
            <div class='tabs-section'>
            <div style="width:100%">
              <h2>Config <a class="options" id="select-all"></a></h2>
            </div>
            </div>
            <div class='code-container left' style="width:100%">
              <textarea id='configjs' style="resize:none"></textarea>
            </div>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="atomizer-web.js"></script>

    <script>
        $(document).ready(function(){
            var markup = $('#markup');
            var atomicCSS = $('#atomic_css');
            var selectAll = $('#select-all');
            var config = $('#config');
            $('#configjs').val(JSON.stringify({

                "breakPoints": {
                        'sm': '@media(min-width=750px)',
                        'md': '@media(min-width=1000px)',
                        'lg': '@media(min-width=1200px)'
                    },
                    "custom": {
                        "1": "1px solid #000",
                        "foo": "2px dotted #f00"
                    },
                    "classNames": [
                        'Bd(1)',
                        'Bd(foo)',
                        'Bd(foo)--sm',
                        'Bd(foo)--md',
                        'D(n)!'
                    ]}       , null, 2));

            // Example
            markup.val('<!-- \n  Paste your markup here \n-->\n\n<div class="Bgc(#0280ae.5) C(#fff) P(20px)">\n  Lorem ipsum\n</div>');
            atomize();

            markup.on('keyup', atomize);
            $('.configjs').on('keyup', atomize);

            selectAll.on('click', function(){
                val = selectAll.text();
                if(val === 'select all'){
                    atomicCSS.select();
                    selectAll.text('deselect all');
                }
                else {
                    document.getSelection().removeAllRanges();
                    selectAll.text('select all');
                }

            });
            config.on('click', function(){
                val = config.text();
                if(val === 'config') {
                    config.text('close');
                    $('.configjs').slideToggle();
                }
                else {
                    config.text('config');
                    $('.configjs').slideToggle(200);
                }
            });

            function atomize(){
                var Atomizer = require('Atomizer');
                var atomizer = new Atomizer();

                var foundClasses = atomizer.findClassNames(markup.val());
                var finalConfig = atomizer.getConfig(foundClasses, getConfig());
                var acss = atomizer.getCss(finalConfig);
                acss = '/**\n * Uses Atomizer build v3.2.1. \n * Copyright (c) 2015, Yahoo Inc. All rights reserved. \n *\n **/\n\n' + acss;
                atomicCSS.val(acss);
            }

            function getConfig(){
                return JSON.parse($('#configjs').val());
            }
        });
    </script>
  </body>
</html>
